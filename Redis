version: '3.7'

services:
  redis1:
    image: redis:7
    container_name: redis1
    command: redis-server --port 6379 --cluster-enabled yes --cluster-config-file nodes.conf --appendonly yes
    ports:
      - "6379:6379"
      - "16379:16379"
    volumes:
      - redis1_data:/data
    restart: unless-stopped

  redis2:
    image: redis:7
    container_name: redis2
    command: redis-server --port 6380 --cluster-enabled yes --cluster-config-file nodes.conf --appendonly yes
    ports:
      - "6380:6380"
      - "16380:16380"
    volumes:
      - redis2_data:/data
    restart: unless-stopped

  redis3:
    image: redis:7
    container_name: redis3
    command: redis-server --port 6381 --cluster-enabled yes --cluster-config-file nodes.conf --appendonly yes
    ports:
      - "6381:6381"
      - "16381:16381"
    volumes:
      - redis3_data:/data
    restart: unless-stopped

  redisinsight:
    image: redis/redisinsight:latest
    container_name: redisinsight
    ports:
      - "5540:5540"
    volumes:
      - redisinsight_data:/data
    restart: unless-stopped

volumes:
  redis1_data:
  redis2_data:
  redis3_data:
  redisinsight_data:
